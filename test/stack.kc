@import(stack)

@definition(system) {
  @implementation(stack) {
    @constructor(char *type, void *ptr) {
      @set(system@stack@_type)(this, type);
      @set(system@stack@_ptr)(this, ptr);
      @set(system@stack@_next)(this, NULL);
    };

    int  push_back(char *type, void *ptr) {
      system@stack *tmp = this;
      while (tmp)
        tmp = @get(system@stack@_next)(tmp);
      @set(system@stack@_next)(tmp, @new(system@stack)(type, ptr));
      return 0;
    };

    int  pop_back() {
      system@stack *tmp = this;
      while (tmp && @get(system@stack@_next)(this) && @get(system@stack@_next)(@get(system@stack@_next)(this)))
        tmp = @get(system@stack@_next)(tmp);
      if (!@get(system@stack@_next)(tmp))
        return 1;
      tmp->_next = NULL;
      return 0;
    };
  };
};