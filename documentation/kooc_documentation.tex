\documentclass{article}

\usepackage[bookmarks]{hyperref}
\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{} % Top left header
\chead{\hmwkProject: \hmwkTitle} % Top center head
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	CODE INCLUSION CONFIGURATION
%----------------------------------------------------------------------------------------
\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0} % This is the color used for comments
\lstloadlanguages{C} % Load Perl syntax for listings, for a list of other languages supported see: ftp://ftp.tex.ac.uk/tex-archive/macros/latex/contrib/listings/listings.pdf
\lstset{language=C, % Use C in this example
        frame=single, % Single frame around code
        basicstyle=\small\ttfamily, % Use small true type font
        keywordstyle=[1]\color{Blue}\bf, % Perl functions bold and blue
        keywordstyle=[2]\color{Purple}, % Perl function arguments purple
        keywordstyle=[3]\color{Blue}\underbar, % Custom functions underlined and blue
        identifierstyle=, % Nothing special about identifiers
        commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, % Comments small dark green courier font
        stringstyle=\color{Purple}, % Strings are purple
        showstringspaces=false, % Don't put marks in string spaces
        tabsize=5, % 5 spaces per tab
        %
        % Put standard Perl functions not included in the default language here
        morekeywords={@new, @delete, @ctor, @dtor},
        %
        % Put Perl function parameters here
        morekeywords=[2]{@namespace, @implementation, @definition, @class},
        %
        % Put user defined functions here
        morekeywords=[3]{@import},
       	%
        morecomment=[l][\color{Blue}]{...}, % Line continuation (...) like blue comment
        numbers=left, % Line numbers on left
        firstnumber=1, % Line numbers start with line 1
        numberstyle=\tiny\color{Blue}, % Line numbers are blue and small
        stepnumber=5 % Line numbers go in steps of 5
}

% Creates a new command to include a perl script, the first parameter is the filename of the script (without .pl), the second parameter is the caption
\newcommand{\KoocCode}[2]{
  \begin{itemize}
  \item[]\lstinputlisting[caption=#2,label=#1]{#1.kc}
  \end{itemize}
}
\newcommand{\KoocHeader}[2]{
  \begin{itemize}
  \item[]\lstinputlisting[caption=#2,label=#1]{#1.kh}
  \end{itemize}
}

\newcommand{\CCode}[2]{
  \begin{itemize}
  \item[]\lstinputlisting[caption=#2,label=#1]{#1.c}
  \end{itemize}
}
\newcommand{\CHeader}[2]{
  \begin{itemize}
  \item[]\lstinputlisting[caption=#2,label=#1]{#1.h}
  \end{itemize}
}

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

%HyperRef Settings
\hypersetup{pdftex,colorlinks=true, allcolors=black}

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterFeature}[1] {
  \nobreak\extramarks{#1}{#1}\nobreak
  \nobreak\extramarks{#1}{#1}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitFeature}[1]{
  \nobreak\extramarks{#1}{#1}\nobreak
  \nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{FeatureCounter} % Creates a counter to keep track of the number of problems

\newcommand{\FeatureName}{}
\newenvironment{Feature}[1][Problem \arabic{FeatureCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
  \stepcounter{FeatureCounter} % Increase counter for number of problems
  \renewcommand{\FeatureName}{#1} % Assign \homeworkProblemName the name of the problem

  \section{\FeatureName} % Make a section in the document with the custom problem count
  \enterFeature{\FeatureName} % Header and footer within the environment
}{
  \exitFeature{\FeatureName} % Header and footer after the environment
}

\newcommand{\FeatureSectionName}{}
\newenvironment{FeatureSection}[1][Test]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
  \renewcommand{\FeatureSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
  \subsection{\FeatureSectionName} % Make a subsection with the custom name of the subsection
  \enterFeature{\FeatureName\ [\FeatureSectionName]} % Header and footer within the environment
}{
  \enterFeature{\FeatureName} % Header and footer after the environment
}

%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Conception} % Assignment title
\newcommand{\hmwkProject}{Kooc} % Course/class
\newcommand{\hmwkAuthorName}{Colliot Vincent, Diego Moran, Frederic Lavrut} % Your name

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
  \vspace{2in}
  \textmd{\textbf{\hmwkProject:\ \hmwkTitle}}\\
  \vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

%\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\newpage
\tableofcontents
\newpage

%----------------------------------------------------------------------------------------
%       Mangling
%----------------------------------------------------------------------------------------

\begin{Feature}[Mangling]
  \begin{FeatureSection}[What]
    Mangling/Name Mangling is a technique used to avoid many problem on unique names resolution. \newline
    Mangling will modify the name following some pattern in order to avoid name collisions. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Why]
      We needed to solve unique name resolution to be able to create a C oriented object. \newline
      When you create a Class in cpp you'r going to set variable and methode in it, if we want to simulate this we need to tell in c that a function is only callable by the struct. \newline
      The solution for this is to change the function name to className\_functionName. \newline
      The function can in fact still be called by the user. This is why we obfuscate the name. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Code Equivalence]
    \KoocHeader{mangling}{ various examples in Kooc }
    \CHeader{mangling}{ various examples in C }
  \end{FeatureSection}
  \begin{FeatureSection}[Implementation]
    \_\_\_[\{nb\}NAMESPACE\_\_]*[\{nb\}CLASS\_\_]?\{nb\}SYMTYPE\_\_\{nb\}SYMNAME[\_\_[\{nb\}TYPARG\_\_]*\{nb\}RETTYPE]?\_\_ \newline
    \{nb\} = len(word) \newline
    When we mangle we add \_\_\_ as separator at the begining and \_\_ between informations, before all informations we tell the lenght of the information. \newline
    We mangle with all the namespaces, the class if present. Symtype makes the difference between a function or a variable. Symname is the name given to this symbol. \newline
    Then, if it's a function, we also mangle with every argument's type, and the return type. \newline
    This is implemented by a Class who have for purpose to change the variable name like the previous declaration. \newline
  \end{FeatureSection}
\end{Feature}
\clearpage

%----------------------------------------------------------------------------------------
%	Import
%----------------------------------------------------------------------------------------

\begin{Feature}[Import]
  \begin{FeatureSection}[What]
    To support the use of import in our kooc we use an @Import Statement for safe inclusion. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Why]
    We needed to be able to include header in our languague so we used @Import as statement to simulate the \#include.
  \end{FeatureSection}
  \begin{FeatureSection}[Code Equivalence]
    \KoocCode{import}{ Import demo in Kooc code }
    \CCode{import}{ Import translation in C code }
  \end{FeatureSection}
  \begin{FeatureSection}[Implementation]
    To implement this we created a custom node (Imp). \newline
    We pars the statement to change it to a correct C \#include. \newline
    This node is not a part of our work tree and only implement a new meta to C methods. \newline
  \end{FeatureSection}
\end{Feature}
\clearpage

%----------------------------------------------------------------------------------------
%	Namespace
%----------------------------------------------------------------------------------------

\begin{Feature}[Namespace]
  \begin{FeatureSection}[What]
    The purpose of a namespace is to define sub context for declaration of variables and functions. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Why]
    To be able to use our languague as an object oriented languague we needed to add a Namespace declaration. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Code Equivalence]
    \KoocHeader{namespace}{ Namespace demo in Kooc header }
    \CHeader{namespace}{ Namespace translation in C header }
    \KoocCode{namespace}{ Namespace demo in Kooc code }
    \CCode{namespace}{ Namespace translation in C code }
  \end{FeatureSection}
  \begin{FeatureSection}[Implementation]
    The definition of a namespace (called 'module' in the subject) is @namespace(NAME)\{\}, and its implementation is @definition(NAME)\{\} \newline
    We implemented this by detecting Namespace declaration (@definition) and added a node to do all mangling and operation of transformation for a Namespace declaration. \newline
  \end{FeatureSection}
\end{Feature}
\clearpage

%----------------------------------------------------------------------------------------
%	Class
%----------------------------------------------------------------------------------------

\begin{Feature}[Class]
  \begin{FeatureSection}[What]
    A class is an object containing variables and methods. Inheritance and polymorphism is a possibility of classes. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Why]
    To be able to use our languague as an object oriented languague we needed to add a Class declaration. \newline
  \end{FeatureSection}
  \begin{FeatureSection}[Code Equivalence]
    \KoocHeader{class}{ Class demo in Kooc header }
    %% \CHeader{class}{ Class translation in C header }
    \KoocCode{class}{ Class demo in Kooc code }
    %% \CCode{class}{ Class translation in C code }
  \end{FeatureSection}
  \begin{FeatureSection}[Implementation]
    The definition of a class is @class(NAME)\{\}, and its implementation is @implementation(NAME)\{\} \newline
    Methodes can be private or public and can be set to be virtual or override. \newline
    Attribute can be set private or public. \newline
    Like the previous implementation of Namespace we created a node to do the specific mangling and transformation of the code. \newline
  \end{FeatureSection}
\end{Feature}
\clearpage

%----------------------------------------------------------------------------------------
%	Exception
%----------------------------------------------------------------------------------------

\begin{Feature}[Exception]
  \begin{FeatureSection}[What]
    An exception is meant to change the standard flow of the process in case where something went wrong.
  \end{FeatureSection}
  \begin{FeatureSection}[Code Equivalence]
    \KoocCode{exception}{ Class demo in Kooc code }
  \end{FeatureSection}
  \begin{FeatureSection}[Implementation]
    The definition of an exception is @throw(FUNCTION*)(VAR), and you can verify if an exception occured with @try\{\}. If an exception occured you may want to catch it with @catch(FUNCTION*)\{\}
  \end{FeatureSection}
\end{Feature}
\clearpage

%----------------------------------------------------------------------------------------

\end{document}
